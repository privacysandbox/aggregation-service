diff --git a/operator/terraform/aws/modules/worker/main.tf b/operator/terraform/aws/modules/worker/main.tf
index 47658ba8f..af3d7e5b7 100644
--- a/operator/terraform/aws/modules/worker/main.tf
+++ b/operator/terraform/aws/modules/worker/main.tf
@@ -252,6 +252,7 @@ data "aws_iam_policy_document" "enclave_policy_doc" {
     actions = [
       "logs:PutLogEvents",
       "logs:CreateLogStream",
+      "logs:CreateLogGroup",
       "xray:PutTelemetryRecords",
       "xray:PutTraceSegments",
     ]
diff --git a/build_defs/aws/kmstool/kmstool.patch b/build_defs/aws/kmstool/kmstool.patch
index c607d9d97..4a2b2a68e 100644
--- a/build_defs/aws/kmstool/kmstool.patch
+++ b/build_defs/aws/kmstool/kmstool.patch
@@ -22,10 +22,10 @@ index f810459..272b39e 100644
      /* Sets the AWS credentials and creates a KMS client with them. */
      struct aws_credentials *new_credentials = aws_credentials_new(
 diff --git a/containers/Dockerfile.al2 b/containers/Dockerfile.al2
-index e166022..ed9ea21 100644
+index e166022..056284b 100644
 --- a/containers/Dockerfile.al2
 +++ b/containers/Dockerfile.al2
-@@ -1,15 +1,15 @@
+@@ -1,20 +1,20 @@
  # Copyright 2020-2022 Amazon.com, Inc. or its affiliates. All Rights Reserved.
  # SPDX-License-Identifier: Apache-2.0
  
@@ -44,3 +44,524 @@ index e166022..ed9ea21 100644
  	go \
  	ninja-build \
  	doxygen
+ 
+-RUN curl https://sh.rustup.rs -sSf | sh -s -- -y --profile minimal --default-toolchain 1.60
++RUN curl https://sh.rustup.rs -sSf | sh -s -- -y --profile minimal --default-toolchain 1.63
+ 
+ # We keep the build artifacts in the -build directory
+ WORKDIR /tmp/crt-builder
+@@ -61,7 +61,9 @@ RUN cmake3 -DCMAKE_PREFIX_PATH=/usr -DBUILD_TESTING=0 -DCMAKE_INSTALL_PREFIX=/us
+ RUN cmake3 --build json-c/build --parallel $(nproc)  --target install
+ 
+ RUN git clone -b v0.2.1 https://github.com/aws/aws-nitro-enclaves-nsm-api.git
+-RUN source $HOME/.cargo/env && cd aws-nitro-enclaves-nsm-api && cargo build --release --jobs $(nproc) -p nsm-lib
++ADD nsm-api.patch /tmp/crt-builder/nsm-api.patch
++RUN cd aws-nitro-enclaves-nsm-api && git apply /tmp/crt-builder/nsm-api.patch
++RUN source $HOME/.cargo/env && cd aws-nitro-enclaves-nsm-api && cargo build --locked --release --jobs $(nproc) -p nsm-lib
+ RUN mv aws-nitro-enclaves-nsm-api/target/release/libnsm.so /usr/lib64
+ RUN mv aws-nitro-enclaves-nsm-api/target/release/nsm.h /usr/include
+ 
+diff --git a/nsm-api.patch b/nsm-api.patch
+new file mode 100644
+index 0000000..c170847
+--- /dev/null
++++ b/nsm-api.patch
+@@ -0,0 +1,498 @@
++diff --git a/.gitignore b/.gitignore
++index a9d37c5..eb5a316 100644
++--- a/.gitignore
+++++ b/.gitignore
++@@ -1,2 +1 @@
++ target
++-Cargo.lock
++diff --git a/Cargo.lock b/Cargo.lock
++new file mode 100644
++index 0000000..e1f7ab0
++--- /dev/null
+++++ b/Cargo.lock
++@@ -0,0 +1,464 @@
+++# This file is automatically @generated by Cargo.
+++# It is not intended for manual editing.
+++version = 3
+++
+++[[package]]
+++name = "arc-swap"
+++version = "0.3.11"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "bc4662175ead9cd84451d5c35070517777949a2ed84551764129cedb88384841"
+++
+++[[package]]
+++name = "autocfg"
+++version = "1.1.0"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "d468802bab17cbc0cc575e9b053f41e72aa36bfa6b7f55e3529ffa43161b97fa"
+++
+++[[package]]
+++name = "aws-nitro-enclaves-nsm-api"
+++version = "0.2.1"
+++dependencies = [
+++ "libc",
+++ "linux-raw-sys",
+++ "log",
+++ "nix 0.20.2",
+++ "serde",
+++ "serde_bytes",
+++ "serde_cbor",
+++]
+++
+++[[package]]
+++name = "bitflags"
+++version = "1.2.1"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "cf1de2fe8c75bc145a2f577add951f8134889b4795d47466a54a5c846d691693"
+++
+++[[package]]
+++name = "bitflags"
+++version = "2.3.3"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "630be753d4e58660abd17930c71b647fe46c27ea6b63cc59e1e3851406972e42"
+++
+++[[package]]
+++name = "cbindgen"
+++version = "0.21.0"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "485ede05a56152367a6ec586a7425b475d6c3d3838581ff651d2a6e3730a62ef"
+++dependencies = [
+++ "heck",
+++ "indexmap",
+++ "log",
+++ "proc-macro2",
+++ "quote",
+++ "serde",
+++ "serde_json",
+++ "syn 1.0.109",
+++ "tempfile",
+++ "toml",
+++]
+++
+++[[package]]
+++name = "cc"
+++version = "1.0.79"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "50d30906286121d95be3d479533b458f87493b30a4b5f79a607db8f5d11aa91f"
+++
+++[[package]]
+++name = "cfg-if"
+++version = "1.0.0"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "baf1de4339761588bc0619e3cbc0120ee582ebb74b53b4efbf79117bd2da40fd"
+++
+++[[package]]
+++name = "errno"
+++version = "0.3.2"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "6b30f669a7961ef1631673d2766cc92f52d64f7ef354d4fe0ddfd30ed52f0f4f"
+++dependencies = [
+++ "errno-dragonfly",
+++ "libc",
+++ "windows-sys",
+++]
+++
+++[[package]]
+++name = "errno-dragonfly"
+++version = "0.1.2"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "aa68f1b12764fab894d2755d2518754e71b4fd80ecfb822714a1206c2aab39bf"
+++dependencies = [
+++ "cc",
+++ "libc",
+++]
+++
+++[[package]]
+++name = "fastrand"
+++version = "2.0.0"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "6999dc1837253364c2ebb0704ba97994bd874e8f195d665c50b7548f6ea92764"
+++
+++[[package]]
+++name = "half"
+++version = "1.8.2"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "eabb4a44450da02c90444cf74558da904edde8fb4e9035a9a6a4e15445af0bd7"
+++
+++[[package]]
+++name = "hashbrown"
+++version = "0.12.3"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "8a9ee70c43aaf417c914396645a0fa852624801b24ebb7ae78fe8272889ac888"
+++
+++[[package]]
+++name = "heck"
+++version = "0.4.1"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "95505c38b4572b2d910cecb0281560f54b440a19336cbbcb27bf6ce6adc6f5a8"
+++
+++[[package]]
+++name = "hermit-abi"
+++version = "0.3.2"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "443144c8cdadd93ebf52ddb4056d257f5b52c04d3c804e657d19eb73fc33668b"
+++
+++[[package]]
+++name = "indexmap"
+++version = "1.9.3"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "bd070e393353796e801d209ad339e89596eb4c8d430d18ede6a1cced8fafbd99"
+++dependencies = [
+++ "autocfg",
+++ "hashbrown",
+++]
+++
+++[[package]]
+++name = "itoa"
+++version = "1.0.9"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "af150ab688ff2122fcef229be89cb50dd66af9e01a4ff320cc137eecc9bacc38"
+++
+++[[package]]
+++name = "libc"
+++version = "0.2.147"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "b4668fb0ea861c1df094127ac5f1da3409a82116a4ba74fca2e58ef927159bb3"
+++
+++[[package]]
+++name = "linux-raw-sys"
+++version = "0.4.3"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "09fc20d2ca12cb9f044c93e3bd6d32d523e6e2ec3db4f7b2939cd99026ecd3f0"
+++
+++[[package]]
+++name = "log"
+++version = "0.4.19"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "b06a4cde4c0f271a446782e3eff8de789548ce57dbc8eca9292c27f4a42004b4"
+++
+++[[package]]
+++name = "memoffset"
+++version = "0.6.5"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "5aa361d4faea93603064a027415f07bd8e1d5c88c9fbf68bf56a285428fd79ce"
+++dependencies = [
+++ "autocfg",
+++]
+++
+++[[package]]
+++name = "nix"
+++version = "0.20.2"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "f5e06129fb611568ef4e868c14b326274959aa70ff7776e9d55323531c374945"
+++dependencies = [
+++ "bitflags 1.2.1",
+++ "cc",
+++ "cfg-if",
+++ "libc",
+++ "memoffset",
+++]
+++
+++[[package]]
+++name = "nix"
+++version = "0.23.2"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "8f3790c00a0150112de0f4cd161e3d7fc4b2d8a5542ffc35f099a2562aecb35c"
+++dependencies = [
+++ "bitflags 1.2.1",
+++ "cc",
+++ "cfg-if",
+++ "libc",
+++ "memoffset",
+++]
+++
+++[[package]]
+++name = "nsm-lib"
+++version = "0.2.1"
+++dependencies = [
+++ "aws-nitro-enclaves-nsm-api",
+++ "cbindgen",
+++ "serde_bytes",
+++]
+++
+++[[package]]
+++name = "nsm-test"
+++version = "0.2.1"
+++dependencies = [
+++ "aws-nitro-enclaves-nsm-api",
+++ "nix 0.20.2",
+++ "nsm-lib",
+++ "serde_bytes",
+++ "serde_cbor",
+++ "signal-hook",
+++ "threadpool",
+++ "vsock",
+++]
+++
+++[[package]]
+++name = "num_cpus"
+++version = "1.16.0"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "4161fcb6d602d4d2081af7c3a45852d875a03dd337a6bfdd6e06407b61342a43"
+++dependencies = [
+++ "hermit-abi",
+++ "libc",
+++]
+++
+++[[package]]
+++name = "proc-macro2"
+++version = "1.0.66"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "18fb31db3f9bddb2ea821cde30a9f70117e3f119938b5ee630b7403aa6e2ead9"
+++dependencies = [
+++ "unicode-ident",
+++]
+++
+++[[package]]
+++name = "quote"
+++version = "1.0.32"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "50f3b39ccfb720540debaa0164757101c08ecb8d326b15358ce76a62c7e85965"
+++dependencies = [
+++ "proc-macro2",
+++]
+++
+++[[package]]
+++name = "redox_syscall"
+++version = "0.3.5"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "567664f262709473930a4bf9e51bf2ebf3348f2e748ccc50dea20646858f8f29"
+++dependencies = [
+++ "bitflags 1.2.1",
+++]
+++
+++[[package]]
+++name = "rustix"
+++version = "0.38.4"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "0a962918ea88d644592894bc6dc55acc6c0956488adcebbfb6e273506b7fd6e5"
+++dependencies = [
+++ "bitflags 2.3.3",
+++ "errno",
+++ "libc",
+++ "linux-raw-sys",
+++ "windows-sys",
+++]
+++
+++[[package]]
+++name = "ryu"
+++version = "1.0.15"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "1ad4cc8da4ef723ed60bced201181d83791ad433213d8c24efffda1eec85d741"
+++
+++[[package]]
+++name = "serde"
+++version = "1.0.177"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "63ba2516aa6bf82e0b19ca8b50019d52df58455d3cf9bdaf6315225fdd0c560a"
+++dependencies = [
+++ "serde_derive",
+++]
+++
+++[[package]]
+++name = "serde_bytes"
+++version = "0.11.12"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "ab33ec92f677585af6d88c65593ae2375adde54efdbf16d597f2cbc7a6d368ff"
+++dependencies = [
+++ "serde",
+++]
+++
+++[[package]]
+++name = "serde_cbor"
+++version = "0.11.2"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "2bef2ebfde456fb76bbcf9f59315333decc4fda0b2b44b420243c11e0f5ec1f5"
+++dependencies = [
+++ "half",
+++ "serde",
+++]
+++
+++[[package]]
+++name = "serde_derive"
+++version = "1.0.177"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "401797fe7833d72109fedec6bfcbe67c0eed9b99772f26eb8afd261f0abc6fd3"
+++dependencies = [
+++ "proc-macro2",
+++ "quote",
+++ "syn 2.0.28",
+++]
+++
+++[[package]]
+++name = "serde_json"
+++version = "1.0.104"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "076066c5f1078eac5b722a31827a8832fe108bed65dfa75e233c89f8206e976c"
+++dependencies = [
+++ "itoa",
+++ "ryu",
+++ "serde",
+++]
+++
+++[[package]]
+++name = "signal-hook"
+++version = "0.1.8"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "97a47ae722318beceb0294e6f3d601205a1e6abaa4437d9d33e3a212233e3021"
+++dependencies = [
+++ "arc-swap",
+++ "libc",
+++]
+++
+++[[package]]
+++name = "syn"
+++version = "1.0.109"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "72b64191b275b66ffe2469e8af2c1cfe3bafa67b529ead792a6d0160888b4237"
+++dependencies = [
+++ "proc-macro2",
+++ "quote",
+++ "unicode-ident",
+++]
+++
+++[[package]]
+++name = "syn"
+++version = "2.0.28"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "04361975b3f5e348b2189d8dc55bc942f278b2d482a6a0365de5bdd62d351567"
+++dependencies = [
+++ "proc-macro2",
+++ "quote",
+++ "unicode-ident",
+++]
+++
+++[[package]]
+++name = "tempfile"
+++version = "3.7.0"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "5486094ee78b2e5038a6382ed7645bc084dc2ec433426ca4c3cb61e2007b8998"
+++dependencies = [
+++ "cfg-if",
+++ "fastrand",
+++ "redox_syscall",
+++ "rustix",
+++ "windows-sys",
+++]
+++
+++[[package]]
+++name = "threadpool"
+++version = "1.8.1"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "d050e60b33d41c19108b32cea32164033a9013fe3b46cbd4457559bfbf77afaa"
+++dependencies = [
+++ "num_cpus",
+++]
+++
+++[[package]]
+++name = "toml"
+++version = "0.5.11"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "f4f7f0dd8d50a853a531c426359045b1998f04219d88799810762cd4ad314234"
+++dependencies = [
+++ "serde",
+++]
+++
+++[[package]]
+++name = "unicode-ident"
+++version = "1.0.11"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "301abaae475aa91687eb82514b328ab47a211a533026cb25fc3e519b86adfc3c"
+++
+++[[package]]
+++name = "vsock"
+++version = "0.2.6"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "e32675ee2b3ce5df274c0ab52d19b28789632406277ca26bffee79a8e27dc133"
+++dependencies = [
+++ "libc",
+++ "nix 0.23.2",
+++]
+++
+++[[package]]
+++name = "windows-sys"
+++version = "0.48.0"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "677d2418bec65e3338edb076e806bc1ec15693c5d0104683f2efe857f61056a9"
+++dependencies = [
+++ "windows-targets",
+++]
+++
+++[[package]]
+++name = "windows-targets"
+++version = "0.48.1"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "05d4b17490f70499f20b9e791dcf6a299785ce8af4d709018206dc5b4953e95f"
+++dependencies = [
+++ "windows_aarch64_gnullvm",
+++ "windows_aarch64_msvc",
+++ "windows_i686_gnu",
+++ "windows_i686_msvc",
+++ "windows_x86_64_gnu",
+++ "windows_x86_64_gnullvm",
+++ "windows_x86_64_msvc",
+++]
+++
+++[[package]]
+++name = "windows_aarch64_gnullvm"
+++version = "0.48.0"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "91ae572e1b79dba883e0d315474df7305d12f569b400fcf90581b06062f7e1bc"
+++
+++[[package]]
+++name = "windows_aarch64_msvc"
+++version = "0.48.0"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "b2ef27e0d7bdfcfc7b868b317c1d32c641a6fe4629c171b8928c7b08d98d7cf3"
+++
+++[[package]]
+++name = "windows_i686_gnu"
+++version = "0.48.0"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "622a1962a7db830d6fd0a69683c80a18fda201879f0f447f065a3b7467daa241"
+++
+++[[package]]
+++name = "windows_i686_msvc"
+++version = "0.48.0"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "4542c6e364ce21bf45d69fdd2a8e455fa38d316158cfd43b3ac1c5b1b19f8e00"
+++
+++[[package]]
+++name = "windows_x86_64_gnu"
+++version = "0.48.0"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "ca2b8a661f7628cbd23440e50b05d705db3686f894fc9580820623656af974b1"
+++
+++[[package]]
+++name = "windows_x86_64_gnullvm"
+++version = "0.48.0"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "7896dbc1f41e08872e9d5e8f8baa8fdd2677f29468c4e156210174edc7f7b953"
+++
+++[[package]]
+++name = "windows_x86_64_msvc"
+++version = "0.48.0"
+++source = "registry+https://github.com/rust-lang/crates.io-index"
+++checksum = "1a515f5799fe4961cb532f983ce2b23082366b898e52ffbce459c86f67c8378a"
++diff --git a/Cargo.toml b/Cargo.toml
++index 86e8df1..b5e630b 100644
++--- a/Cargo.toml
+++++ b/Cargo.toml
++@@ -17,9 +17,10 @@ default-members = [ "." ]
++ lto = true
++ 
++ [dependencies]
++-nix = "0.20"
++-libc = "0.2"
++-log = "0.4"
++-serde = { version = "1.0", features = ["derive"] }
++-serde_bytes = "0.11"
++-serde_cbor = "0.11"
+++nix = "0.20.2, < 0.20.3"
+++libc = "0.2.147, < 0.2.148"
+++log = "0.4.19, < 0.4.20"
+++serde = { version = "1.0.177, < 1.0.178", features = ["derive"] }
+++serde_bytes = "0.11.12, < 0.11.13"
+++serde_cbor = "0.11.2, < 0.11.3"
+++linux-raw-sys = "0.4.3, < 0.4.4"
